<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TinyChat</title>
    
    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
    <link rel="icon" type="image/svg+xml" sizes="32x32" href="/static/favicon-32x32.svg">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/apple-touch-icon.svg">
    
    <!-- External Libraries -->
    <!-- Markdown rendering -->
    <script src="https://cdn.jsdelivr.net/npm/marked@11.1.1/marked.min.js"></script>
    
    <!-- Syntax highlighting for code blocks -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- KaTeX for math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    
    <!-- Application Styles -->
    <link rel="stylesheet" href="/static/css/base.css">
    <link rel="stylesheet" href="/static/css/layout.css">
    <link rel="stylesheet" href="/static/css/sidebar.css">
    <link rel="stylesheet" href="/static/css/components.css">
    <link rel="stylesheet" href="/static/css/chat.css">
</head>
<body>
    <div class="sidebar">
        <div class="sidebar-header">
            <button class="new-chat-btn" onclick="createNewConversation()">+ New Chat</button>
            <button class="clear-all-btn" onclick="clearAllConversations()">Clear All</button>
        </div>
        <div class="conversations" id="conversations">
            <!-- Conversations will be loaded here -->
        </div>
    </div>

    <div class="main-content">
        <div class="chat-header">
            <div class="chat-title">TinyChat</div>
            <div class="settings">
                <div class="setting-group">
                    <label for="temperature">Temperature:</label>
                    <input type="range" id="temperature" min="0" max="2" step="0.1" value="0.7">
                    <span id="temperature-value">0.7</span>
                </div>
                <div class="setting-group">
                    <label for="model">Model:</label>
                    <select id="model">
                        <option value="">Loading...</option>
                    </select>
                </div>
                <div class="setting-group">
                    <input type="checkbox" id="markdownToggle" checked>
                    <label for="markdownToggle">Render Markdown</label>
                </div>
                <div class="setting-group">
                    <input type="checkbox" id="rlmToggle">
                    <label for="rlmToggle">Use RLM</label>
                </div>
                <div class="setting-group" id="rlmThinkingGroup">
                    <input type="checkbox" id="rlmThinkingToggle" checked>
                    <label for="rlmThinkingToggle">Show RLM Thinking</label>
                </div>
            </div>
        </div>

        <div class="chat-messages" id="messages">
            <div style="text-align: center; color: #999; margin-top: 50px; max-width: 600px; margin-left: auto; margin-right: auto; line-height: 1.6;">
                <div style="font-size: 20px; font-weight: 600; margin-bottom: 16px;">Welcome to TinyChat! ðŸ‘‹</div>
                <div style="margin-bottom: 12px;">Start a conversation by typing a message below.</div>
                <div style="font-size: 13px; color: #666; padding: 12px; background: #f8f9fa; border-radius: 8px; margin-top: 20px;">
                    <strong>Educational &amp; Research</strong><br>
                    This language model is intended for educational and research purposes. 
                    AI models can make mistakes. Please verify important information and double-check all responses.
                </div>
            </div>
        </div>

        <div class="typing-indicator" id="typing">Assistant is typing...</div>
        <div class="rlm-status-indicator" id="rlmStatus">ðŸ§  RLM thinking...</div>

        <div class="chat-input-area">
            <div class="input-container">
                <!-- Image preview area -->
                <div id="imagePreview" class="image-preview" style="display: none;">
                    <img id="previewImg" src="" alt="Preview">
                    <div class="image-info">
                        <span id="imageFileName"></span>
                        <button class="remove-image" onclick="removeAttachedImage()" title="Remove image">Ã—</button>
                    </div>
                </div>
                
                <!-- Hidden file input -->
                <input type="file" id="imageInput" accept="image/jpeg,image/png,image/gif,image/webp" style="display: none;">
                
                <!-- Input row with attach button -->
                <div class="input-row">
                    <button class="attach-btn" onclick="document.getElementById('imageInput').click()" title="Attach image">
                        ðŸ“Ž
                    </button>
                    <textarea 
                        class="message-input" 
                        id="messageInput" 
                        placeholder="Type your message here..."
                        rows="1"
                    ></textarea>
                    <button class="send-btn" id="sendBtn" onclick="sendMessage()">Send</button>
                </div>
            </div>
        </div>

        <div class="footer" id="footer">
            TinyChat v<span id="version">...</span> | <a href="https://github.com/jasonacox/tinychat" target="_blank">GitHub</a>
        </div>
    </div>

    <!-- Application Scripts - Order matters! -->
    <script src="/static/js/config.js"></script>
    <script src="/static/js/utils/storage.js"></script>
    <script src="/static/js/utils/markdown.js"></script>
    <script src="/static/js/utils/image.js"></script>
    <script src="/static/js/components/rlm-security.js"></script>
    <script src="/static/js/components/sidebar.js"></script>
    <script src="/static/js/components/chat.js"></script>
    <script src="/static/js/app.js"></script>
</body>
</html>
